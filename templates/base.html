{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}StockPro - Smart Trading Insights{% endblock %}</title>

    <!-- Design System Foundation (Tailwind + Manrope + Material Symbols) -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#2D3748",
                        "primary-soft": "#4A5568",
                        "background-base": "#F7F8FA",
                        "surface": "#FFFFFF",
                        "text-main": "#2D3748",
                        "text-muted": "#718096",
                        "accent-gold": "#D69E2E",
                        "accent-teal": "#38B2AC",
                        "accent-coral": "#FC8181",
                        "accent-teal-soft": "#E6FFFA",
                        "accent-coral-soft": "#FFF5F5",
                    },
                    fontFamily: {
                        sans: ["Manrope", "sans-serif"],
                        display: ["Manrope", "sans-serif"],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'soft-hover': '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05)',
                        'inner-soft': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.02)',
                    }
                },
            },
        }
    </script>

    <!-- Legacy Style (Maintained for basic structure) -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    
    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { font-family: 'Manrope', sans-serif; background: #F7F8FA; color: #2D3748; }
    </style>
    {% block page_css %}{% endblock %}
    {% block extra_css %}{% endblock %}
</head>
<body class="antialiased text-text-main">
    
    {% if user.is_authenticated and '/auth/' not in request.path and '/admin/' not in request.path %}
    {# ── APP MODE ── #}
    <div class="flex min-h-screen w-full bg-background-base">
        {% include 'partials/customer_sidebar.html' %}
        <main class="flex-1 flex flex-col min-h-screen bg-background-base">
            <header class="h-20 flex items-center justify-between px-8 sticky top-0 z-20 bg-background-base/90 backdrop-blur-sm">
                <div class="hidden md:flex items-center max-w-md w-full">
                    <div class="relative w-full group">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-text-muted group-focus-within:text-accent-teal transition-colors material-symbols-outlined text-[20px]">search</span>
                        <input class="w-full bg-surface shadow-soft rounded-full pl-12 pr-6 py-3 text-sm text-text-main placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-accent-teal/20 transition-all border-none" placeholder="Search stocks, indices..." type="text">
                    </div>
                </div>
                <div class="flex items-center gap-6 ml-auto">
                    {% if not user.subscription %}
                    <a href="{% url 'payments:membership' %}" class="hidden sm:flex bg-accent-gold/10 hover:bg-accent-gold/20 text-accent-gold px-5 py-2.5 rounded-full text-sm font-bold items-center gap-2 transition-all no-underline">
                        <span class="material-symbols-outlined text-[18px]">diamond</span>
                        <span>Upgrade to PRO</span>
                    </a>
                    {% endif %}
                    <a href="/api/notifications/inbox/" class="relative p-3 bg-surface text-text-muted hover:text-text-main rounded-full shadow-soft hover:shadow-soft-hover transition-all no-underline">
                        <span class="material-symbols-outlined text-[20px]">notifications</span>
                    </a>
                </div>
            </header>
            <div class="flex-1 px-4 md:px-8 pb-8 max-w-7xl mx-auto w-full">
    {% else %}
    {# ── PUBLIC MODE ── #}
    {% include 'partials/navbar.html' %}
    <main class="min-h-screen">
        <div class="container mx-auto px-4 py-8">
    {% endif %}

                {% block page_content %}{% endblock %}
                {% block content %}{% endblock %}

    {% if user.is_authenticated and '/auth/' not in request.path and '/admin/' not in request.path %}
            </div>
        </main>
    </div>
    {% else %}
        </div>
    </main>
    {% include 'partials/footer.html' %}
    {% endif %}

    <!-- Global Scripts -->
    <script src="{% static 'js/main.js' %}"></script>
    {% block page_js %}{% endblock %}
    {% block extra_js %}{% endblock %}
</body>
</html>

